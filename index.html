<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A2 æ³•è¯­è¯æ±‡æ¶ˆæ¶ˆä¹</title>

<style>
/* åŸºæœ¬å¸ƒå±€ */
body {
    font-family: -apple-system, Segoe UI, Roboto, sans-serif;
    background: linear-gradient(135deg, #d8e9ff, #f2f7ff);
    margin: 0;
    padding: 20px;
}

/* å®¹å™¨ */
.container {
    max-width: 900px;
    margin: auto;
}

/* éšè— */
.hidden { display: none !important; }

/* ================================
   ğŸ”µ å¼€å§‹ç•Œé¢ï¼ˆæœç´¢å¼•æ“é£æ ¼ï¼‰
   ================================ */
#start-screen {
    background: white;
    padding: 30px;
    border-radius: 18px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.12);
    text-align: center;
}

#start-screen h1 {
    font-size: 24px;
    color: #2255aa;
    margin-bottom: 20px;
}

.search-box {
    display: flex;
    gap: 10px;
    margin: 20px auto;
    max-width: 500px;
}

.search-box input {
    flex: 1;
    padding: 12px 16px;
    border-radius: 40px;
    border: 2px solid #88aaff;
    font-size: 16px;
}

.search-btn {
    padding: 12px 22px;
    border-radius: 40px;
    border: none;
    background: #3d7bff;
    color: white;
    cursor: pointer;
    font-size: 16px;
    transition: 0.2s;
}

.search-btn:active {
    transform: scale(0.95);
}

/* æ¸¸æˆè¯´æ˜ */
#start-screen ul {
    text-align: left;
    margin-top: 20px;
    line-height: 1.6;
    font-size: 15px;
}

/* ================================
   ğŸŸ¦ æ¸¸æˆç•Œé¢
   ================================ */
#game-screen {
    background: white;
    padding: 20px;
    border-radius: 16px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

/* é¡¶éƒ¨æ  */
.top-bar {
    display: flex;
    justify-content: space-between;
    font-size: 15px;
    margin-bottom: 10px;
}

/* å¡ç‰‡åŒºï¼šæ¡Œé¢ 6 åˆ—ï¼Œæ‰‹æœº 2 åˆ— */
#game-board {
    display: grid;
    gap: 12px;
    margin-top: 15px;
}

@media (min-width: 800px) {
    #game-board {
        grid-template-columns: repeat(6, 1fr);
    }
}

@media (max-width: 799px) {
    #game-board {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* å•è¯å¡ç‰‡ */
.card {
    padding: 16px 10px;
    border-radius: 12px;
    text-align: center;
    cursor: pointer;
    border: 2px solid #79a9ff;
    background: #fff;
    transition: transform .15s;
    font-size: 18px;
    min-height: 70px;
    display: flex;
    justify-content: center;
    align-items: center;
}

.card:active {
    transform: scale(0.92);
}

/* é¢œè‰²åŒºåˆ† */
.card.fr { color: #1a57d2; border-color:#4d7fff; }
.card.zh { color: #d12d2d; border-color:#ff7a7a; }

.card.selected { background: #e8f0ff; }
.card.matched { visibility: hidden; }

/* ================================
   ğŸ‰ èƒœåˆ©åŠ¨ç”»ï¼ˆçº¯ CSSï¼Œæ— å›¾ç‰‡ï¼‰
   ================================ */
#result-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.35);
    display: flex;
    justify-content: center;
    align-items: center;
}

.result-card {
    background: white;
    padding: 25px;
    border-radius: 20px;
    width: 300px;
    text-align: center;
    animation: pop 0.4s ease-out;
}

@keyframes pop {
    from { transform: scale(0.5); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}

.fireworks {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    pointer-events:none;
    overflow:hidden;
}

.fireworks span {
    position:absolute;
    width:6px;
    height:6px;
    background: yellow;
    border-radius:50%;
    animation: boom 1s ease-out forwards;
}

@keyframes boom {
    0% { transform: translate(0,0) scale(1); opacity:1; }
    100% { transform: translate(var(--x), var(--y)) scale(0.1); opacity:0; }
}

</style>
</head>

<body>

<div class="container">

<!-- ======================
     ğŸ”µ å¼€å§‹ç•Œé¢
     ====================== -->
<div id="start-screen">
    <h1>ğŸ‘‹ A2 æ³•è¯­è¯æ±‡æ¶ˆæ¶ˆä¹</h1>

    <div class="search-box">
        <input id="player-name" type="text" placeholder="è¯·è¾“å…¥å§“åâ€¦">
        <button class="search-btn" id="start-btn">å¼€å§‹ â–¶</button>
    </div>

    <ul>
        <li>ç‚¹å‡»ä¸€ä¸ª<strong>æ³•è¯­</strong>æ³¡æ³¡ï¼Œå†ç‚¹å‡»å¯¹åº”çš„<strong>ä¸­æ–‡</strong>æ³¡æ³¡ã€‚</li>
        <li>é…å¯¹æ­£ç¡® â†’ æ³¡æ³¡æ¶ˆå¤±ï¼›é”™è¯¯ â†’ æ³¡æ³¡æ¢å¤å¹¶ +1 é”™è¯¯æ¬¡æ•°ã€‚</li>
        <li>å…¨éƒ¨æ¶ˆé™¤åï¼Œä¼šæ˜¾ç¤ºä½ çš„æˆç»©ä¸èƒœåˆ©åŠ¨ç”»ã€‚</li>
        <li>æ¡Œé¢ç«¯ï¼šç‚¹å‡»æ³•è¯­å•è¯ä¼šå‘éŸ³ï¼›æ‰‹æœºç«¯ï¼šè‡ªåŠ¨é™éŸ³ã€‚</li>
    </ul>
</div>

<!-- ======================
     ğŸŸ¦ æ¸¸æˆç•Œé¢
     ====================== -->
<div id="game-screen" class="hidden">

    <div class="top-bar">
        <div>ğŸ‘¤ å­¦ç”Ÿï¼š<span id="display-name">â€”</span></div>
        <div>â± æ—¶é—´ï¼š<span id="time-display">00:00</span></div>
        <div>âŒ é”™è¯¯ï¼š<span id="error-count">0</span></div>
    </div>

    <div id="game-board"></div>
</div>

<!-- ======================
     ğŸ‰ ç»“æŸç•Œé¢
     ====================== -->
<div id="result-overlay" class="hidden">
    <div class="result-card">
        <h2>ğŸ‰ æ­å–œå®Œæˆï¼</h2>
        <p>å§“åï¼š<span id="result-name"></span></p>
        <p>ç”¨æ—¶ï¼š<span id="result-time"></span></p>
        <p>é”™è¯¯ï¼š<span id="result-errors"></span></p>
        <button class="search-btn" id="play-again-btn">å†ç©ä¸€æ¬¡ ğŸ”</button>
    </div>
</div>

<div class="fireworks" id="fireworks"></div>

</div> <!-- container end -->

<script>
/* =======================
   A2 æ³•è¯­è¯æ±‡
   ======================= */
const vocab = [
 {fr:"servir Ã  qn", zh:"å¯¹æŸäººæœ‰ç”¨"},
 {fr:"serrer qn contre son cÅ“ur", zh:"å°†æŸäººç´§ç´§æŠ±åœ¨æ€€é‡Œ"},
 {fr:"avec calme", zh:"å¹³é™åœ°ï¼›å†·é™åœ°"},
 {fr:"timide", zh:"ç¾æ€¯çš„ï¼›è…¼è…†çš„"},
 {fr:"dur", zh:"ç¡¬çš„ï¼›è‰°éš¾çš„"},
 {fr:"s'abriter", zh:"èº²é¿ï¼›é¿éš¾"},
 {fr:"optimiste", zh:"ä¹è§‚çš„"},
 {fr:"pessimiste", zh:"æ‚²è§‚çš„"},
 {fr:"en bons termes", zh:"å…³ç³»èæ´½"},
 {fr:"rÃ©servÃ©(e)", zh:"å†…å‘çš„ï¼›çŸœæŒçš„"},
 {fr:"bavard(e)", zh:"çˆ±è¯´è¯çš„ï¼›å” å¨çš„"},
 {fr:"arrogant(e)", zh:"å‚²æ…¢çš„ï¼›è‡ªå¤§çš„"},
 {fr:"temporaire", zh:"ä¸´æ—¶çš„ï¼›æš‚æ—¶çš„"},
 {fr:"hÃ©sitant(e)", zh:"çŠ¹è±«çš„"},
 {fr:"doux(ce)", zh:"æŸ”è½¯çš„ï¼›æ¸©å’Œçš„ï¼›ç”œçš„"},
 {fr:"tendre", zh:"å«©çš„ï¼›æŸ”è½¯çš„ï¼›æ¸©æŸ”çš„"},
 {fr:"se dÃ©courager", zh:"ç°å¿ƒï¼›æ³„æ°”"},
 {fr:"sâ€™exposer", zh:"æš´éœ²è‡ªå·±ï¼›å†’é™©"},
 {fr:"confiant(e)", zh:"è‡ªä¿¡çš„ï¼›ä¿¡ä»»çš„"},
 {fr:"rater le projet", zh:"é¡¹ç›®å¤±è´¥ï¼›æŠŠé¡¹ç›®æç ¸"},
 {fr:"mener qch Ã  bien", zh:"æŠŠæŸäº‹é¡ºåˆ©å®Œæˆ"},
 {fr:"en conflit", zh:"å¤„äºå†²çªä¸­"},
 {fr:"en paix", zh:"å’Œå¹³ç›¸å¤„ï¼›å®‰å®åœ°"},
];

/* =======================
   æ³•è¯­å‘éŸ³ï¼ˆæ¡Œé¢æœ‰æ•ˆï¼Œæ‰‹æœºé™éŸ³ï¼‰
   ======================= */
let frenchVoice = null;

function loadVoices() {
    let voices = speechSynthesis.getVoices();
    frenchVoice = voices.find(v => v.lang.startsWith("fr"));
}

if ("speechSynthesis" in window) {
    speechSynthesis.onvoiceschanged = loadVoices;
    loadVoices();
}

function speakFR(text) {
    if (!("speechSynthesis" in window)) return;
    if (!frenchVoice) return;  // æ‰‹æœºç«¯é™éŸ³

    let u = new SpeechSynthesisUtterance(text);
    u.lang = "fr-FR";
    u.voice = frenchVoice;
    speechSynthesis.speak(u);
}

/* =======================
   æ¸¸æˆ
   ======================= */
const startBtn = document.querySelector("#start-btn");
const playerInput = document.querySelector("#player-name");
const startScreen = document.querySelector("#start-screen");
const gameScreen = document.querySelector("#game-screen");
const gameBoard = document.querySelector("#game-board");

const displayName = document.querySelector("#display-name");
const timerDisplay = document.querySelector("#time-display");
const errorDisplay = document.querySelector("#error-count");

const resultOverlay = document.querySelector("#result-overlay");
const fireworks = document.querySelector("#fireworks");
const resultName = document.querySelector("#result-name");
const resultTime = document.querySelector("#result-time");
const resultErrors = document.querySelector("#result-errors");
const playAgainBtn = document.querySelector("#play-again-btn");

let first = null, lock=false, matched=0, errors=0, seconds=0, timer;

/* è®¡æ—¶å™¨ */
function startTimer(){
    timer = setInterval(()=>{
        seconds++;
        let m = String(Math.floor(seconds/60)).padStart(2,"0");
        let s = String(seconds%60).padStart(2,"0");
        timerDisplay.textContent = `${m}:${s}`;
    },1000);
}

/* åˆ›å»ºçƒŸèŠ± */
function boom() {
    for(let i=0;i<40;i++){
        let s = document.createElement("span");
        s.style.left = "50%";
        s.style.top = "50%";
        s.style.setProperty("--x", `${(Math.random()*200-100)}px`);
        s.style.setProperty("--y", `${(Math.random()*200-100)}px`);
        fireworks.appendChild(s);
        setTimeout(()=> s.remove(), 1000);
    }
}

/* æ„å»ºæ¸¸æˆç‰Œé¢ */
function buildGame(){
    matched=0; errors=0; seconds=0; first=null; lock=false;
    errorDisplay.textContent=0; timerDisplay.textContent="00:00";
    clearInterval(timer);

    let cards=[];
    vocab.forEach((v,i)=>{
        cards.push({id:i, text:v.fr, type:"fr"});
        cards.push({id:i, text:v.zh, type:"zh"});
    });

    cards.sort(()=>Math.random()-0.5);
    gameBoard.innerHTML="";

    cards.forEach(c=>{
        let div=document.createElement("div");
        div.className = `card ${c.type}`;
        div.textContent = c.text;
        div.dataset.id = c.id;

        div.onclick = ()=>selectCard(div,c.type);
        gameBoard.appendChild(div);
    });

    startTimer();
}

/* é€‰æ‹©å¡ç‰‡ */
function selectCard(card,type){
    if (lock || card.classList.contains("matched") || card.classList.contains("selected")) return;

    card.classList.add("selected");

    if (type==="fr") speakFR(card.textContent);

    if (!first) { first = card; return; }

    if (first.dataset.id === card.dataset.id) {
        first.classList.add("matched");
        card.classList.add("matched");
        matched+=2;
        first=null;

        if (matched === vocab.length*2) finishGame();

    } else {
        lock=true;
        errors++;
        errorDisplay.textContent = errors;
        setTimeout(()=>{
            first.classList.remove("selected");
            card.classList.remove("selected");
            first=null;
            lock=false;
        },600);
    }
}

/* æ¸¸æˆç»“æŸ */
function finishGame(){
    clearInterval(timer);
    boom(); boom(); boom();

    resultName.textContent = displayName.textContent;
    resultTime.textContent = timerDisplay.textContent;
    resultErrors.textContent = errors;

    resultOverlay.classList.remove("hidden");
}

/* å¼€å§‹æ¸¸æˆ */
startBtn.onclick = ()=>{
    let name = playerInput.value.trim();
    if (!name) return alert("è¯·è¾“å…¥å§“å");

    displayName.textContent = name;
    startScreen.classList.add("hidden");
    gameScreen.classList.remove("hidden");
    buildGame();
};

/* å†ç©ä¸€æ¬¡ */
playAgainBtn.onclick = ()=>{
    resultOverlay.classList.add("hidden");
    fireworks.innerHTML = "";
    buildGame();
};

</script>

</body>
</html>
